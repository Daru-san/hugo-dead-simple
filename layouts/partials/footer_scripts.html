<!-- Shortcuts. -->
<script defer>
  document.addEventListener("keydown", function (e) {
    if (document.activeElement.isContentEditable) {
        return false;
    }
    if (document.activeElement.tagName == "INPUT") {
      return false;
    }
    if (e.altKey || e.ctrlKey || e.shiftKey) {
        return false;
    }
     var key = e.key
      if (key === "h") {
        e.preventDefault();
        e.stopPropagation();
        window.location.href = "/";
      } else if (key === "t") {
        e.preventDefault();
        e.stopPropagation();
        window.location.href = "/tags";
      } else if (key === "i") {
        e.preventDefault();
        e.stopPropagation();
          const inputs = document.querySelectorAll('input');
          for (let i = 0; i < inputs.length; i++) {
            if (inputs[i].offsetParent !== null) {
              inputs[i].selectionStart = inputs[i].selectionEnd = inputs[i].value.length;
              inputs[i].focus();
              break;
            }
          }
    }
    return false;
  });
</script>

<!-- Add _blank to all external links. -->
<script defer>
  var links = document.getElementsByTagName("a");

  for (var i = 0, linksLength = links.length; i < linksLength; i++) {
    if (links[i].hostname != window.location.hostname) {
      links[i].target = "_blank";
    }
  }
</script>

<!-- Dynamic toc. -->
<script defer>
  (function () {
    function getScript(url, success) {
      var script = document.createElement("script");
      script.src = url;
      var head = document.getElementsByTagName("head")[0],
        done = false;
      script.onload = script.onreadystatechange = function () {
        if (
          !done &&
          (!this.readyState ||
            this.readyState == "loaded" ||
            this.readyState == "complete")
        ) {
          done = true;
          success();
          script.onload = script.onreadystatechange = null;
          head.removeChild(script);
        }
      };
      head.appendChild(script);
    }
    getScript(
      "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.slim.min.js",
      function () {
        const anchors = $("body").find("h2,h3");

        $(window).scroll(function () {
          var scrollTop = $(document).scrollTop();

          // highlight the last scrolled-to: set everything inactive first
          for (var i = 0; i < anchors.length; i++) {
            $(
              'nav ul li a[href="#' + $(anchors[i]).attr("id") + '"]'
            ).removeClass("active-toc");
          }

          // then iterate backwards, on the first match highlight it and break
          for (var i = anchors.length - 1; i >= 0; i--) {
            if (scrollTop > $(anchors[i]).offset().top - 75) {
              $(
                'nav ul li a[href="#' + $(anchors[i]).attr("id") + '"]'
              ).addClass("active-toc");
              break;
            }
          }
        });
      }
    );
  })();
</script>

<script defer>
function addCopyButtonToCodeBlocks() {
    // Get all code blocks with a class of "language-*"
    const codeBlocks = document.querySelectorAll('code[class^="language-"]');

    codeBlocks.forEach(codeBlock => {
        const copyButton = document.createElement('button');
        copyButton.classList.add('copy-code-button');
        copyButton.innerHTML = 'copy';

        // Add a click event listener to the copy button
        copyButton.addEventListener('click', () => {

            // Copy the code inside the code block to the clipboard
            const elements = codeBlock.querySelectorAll('.cl')
            let codeToCopy = '';
            elements.forEach(element => {
                codeToCopy += element.innerText;
            });
            navigator.clipboard.writeText(codeToCopy);

            // Update the copy button text to indicate that the code has been copied
            copyButton.innerHTML = 'copied!';
            setTimeout(() => {
                copyButton.innerHTML = 'copy';
            }, 1500);
        });

        // Add the copy button to the code block
        codeBlock.parentNode.before(copyButton)
    });
}
setTimeout(
    function() {
        addCopyButtonToCodeBlocks()
    }, 100
)
</script>

